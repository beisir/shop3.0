!function(e){function n(t){if(i[t])return i[t].exports;var a=i[t]={exports:{},id:t,loaded:!1};return e[t].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}var i={};return n.m=e,n.c=i,n.p="//style.org.hc360.cn/js/module/shop3.0/dist/",n(0)}([function(e,n){!function(e){e.fn.queryDialog=function(i){return"function"!=typeof e.cookie&&e.getScript("//style.org.hc360.cn/js/build/source/widgets/jquery.cookie.js"),this.each(function(t,a){e.extend(!0,i,{element:e(a)});var o=new n(i);o.init()})};var n=function(n){this.defaultOptions={is3y:!1,isBindWX:!1,element:"",companyName:"",interval:"",consultContainer:"",providerId:""},e.extend(this.defaultOptions,n)};n.prototype={init:function(){this.createDialogHtml()},bindStatusDef:function(){return e.ajax({url:"//madata.hc360.com/mobileweb/m/get/bindstatus",dataType:"jsonp",data:{imid:window.company_username||window.welfarename||window.userName}})},getMsgContent:function(){var n=this;return e.ajax({url:"//my.b2b.hc360.com/my/turbine/action/outerinf.OnlinePcIMAction/eventsubmit_doGethismsg/doGethismsg",type:"GET",timeout:5e3,data:{buyid:e.cookie("LoginID")?e.cookie("newhcproviderid")||e.cookie("hc360_userid"):e.cookie("HC_anonyBuyerId")||"",isLogon:e.cookie("LoginID")?"1":"0",spid:n.defaultOptions.providerId},dataType:"jsonp",jsonpCallback:"callback"})},getCodeUrlBySceneid:function(n){return e.ajax({url:"//detail.b2b.hc360.com/detail/turbine/action/ajax.MobileBcidAjaxAction/eventsubmit_dochatingpicid/doChatingpicid",type:"GET",data:{senceid:n,imid:"hc360-hfb"},dataType:"jsonp",jsonpCallback:"callback"})},getHistoryMsg:function(n){var i=this;e.when(i.getMsgContent()).done(function(t){if(t&&t.length>0){var a=t,o=a[0].qrcodeid;e('button[data-node-name="subtn"]').attr("data-sceneid",o);for(var s=0;s<a.length;s++)if("0"==a[s].infokind){var d=['<div class="clBoxRig" data-id="'+a[s].id+'">','<em class="clImg"></em>','<div class="clImgRig">','<p class="clTime">\u6211  <span>'+a[s].createtime+"</span></p>",'<div class="ConsulList">',"<em></em>","<p>"+a[s].purchaseinfo||"</p>","</div>","</div>","</div>"];e("#cInnerBox").append(d.join(""))}else if("1"==a[s].infokind){var c=['<div class="clBoxLeft" data-id="'+a[s].id+'">','<em class="clImg"></em>','<div class="clImgRig">','<p class="clTime">\u5e97\u7ecf\u7406  <span>'+a[s].createtime+"</span></p>",'<div class="ConsulList">',"<em></em>","<p>"+a[s].purchaseinfo||"</p>","</div>","</div>","</div>"];e("#cInnerBox").append(c.join(""))}15==t.length&&e("#cInnerBox").prepend('<p class="moreList"><a href="javascript:;">\u70b9\u51fb\u67e5\u770b\u66f4\u591a</a></p>');var l=e('[node-name="friendlyTip"]').find("dl dt img");i.defaultOptions.isBindWX?e.when(i.getCodeUrlBySceneid(o)).done(function(e){e&&e.weChatPic?l.attr("src",e.weChatPic):l.attr("src","//style.org.hc360.com/images/detail/mysite/siteconfig/new_product/newImg/codeImg_3.jpg")}).fail(function(){l.attr("src","//style.org.hc360.com/images/detail/mysite/siteconfig/new_product/newImg/codeImg_3.jpg")}):l.attr("src","//style.org.hc360.com/images/detail/mysite/siteconfig/new_product/newImg/codeImg_3.jpg")}e("#cInnerBox").scrollTop(e("#cInnerBox")[0].scrollHeight),n&&n()}).fail(function(){console.log("Failed to obtain data,Please try again later!")})},getChatWXDef:function(){return e.ajax({url:"//detail.b2b.hc360.com/detail/turbine/action/ajax.MobileBcidAjaxAction/eventsubmit_dowechatpicid/doWechatpicid",type:"GET",dataType:"jsonp",jsonpCallback:"callback",data:{imid:"hc360-hfb"}})},getBindStatusDef:function(){return e.ajax({url:"//madata.hc360.com/mobileweb/m/get/bindstatus",dataType:"jsonp",data:{imid:window.company_username||window.welfarename||window.userName}})},createDialogHtml:function(){var n=this,i=e(".dAlertBoxBg");n.defaultOptions.element.on("click",function(){var t=e(this),a="",o="//style.org.hc360.com/images/detail/mysite/siteconfig/new_product/newImg/codeImg_3.jpg";return!t.attr("isopen")&&(t.attr("isopen",!0),void e.when(n.getChatWXDef()).done(function(t){if(t&&t.senceid&&(a=t.senceid,o=t.weChatPic),0==i.length?i=e("<div>",{"class":"dAlertBoxBg consultBg"}).appendTo("body").show():i.show(),n.defaultOptions.is3y){n.defaultOptions.consultContainer=e("<div>",{"class":"Consultation syConsul","data-node-name":"queryDialog","data-startTime":n.getDateTime(!0)}).appendTo("body").show();var s=n.defaultOptions.consultContainer,d=['<div class="ConsultationCon">','<div class="mTitle">','<div class="mTitLeft">',"<em></em>",'<span class="borLeft">'+n.defaultOptions.companyName+"</span>","</div>",'<span class="mCloseBtn" data-node-nane="closeInqueryDialog">\u5173\u95ed</span>',"</div>",'<div class="ConsulCon">','<div class="ConsulBox">','<div class="clTop" id="cInnerBox"></div>','<div class="clBot">','<div class="clBotText">','<textarea name="" data-node-name="area" placeholder="\u8bf7\u5728\u6b64\u76f4\u63a5\u8f93\u5165\u60a8\u8981\u91c7\u8d2d\u7684\u4ea7\u54c1\u53ca\u5176\u4ed6\u9700\u6c42"></textarea>','<p class="textareaLen" data-node-name="maxLen">\u8fd8\u53ef\u4ee5\u8f93\u5165150\u5b57</p>','<p class="ProhibitedTxt" style="display: none;"><strong></strong>\u5185\u5bb9\u542b\u6709\u8fdd\u7981\u8bcd</p>',"</div>","</div>",'<div class="clBotInput">','<div id="mobilephoneCon">',"<span><em>*</em>\u7535\u8bdd\u53f7\u7801</span>",'<div class="bInputBox">','<input type="text" style="color: rgb(162, 162, 162);" maxLength="11" value="\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801" name="MP" data-node-name="MP">','<em class="c-red warning isNull" style="display: none;"><strong></strong>\u624b\u673a\u53f7\u4e0d\u80fd\u4e3a\u7a7a</em>','<em class="c-red warning isError" style="display: none;"><strong></strong>\u8bf7\u586b\u5199\u6b63\u786e\u7684\u624b\u673a\u53f7</em>',"</div>","</div>",'<div id="validcodeCon">',"<span><em>*</em>\u9a8c\u8bc1\u7801</span>",'<div class="clCode">','<input type="text" class="w210" style="color:#999999;"maxLength="4" value="\u9a8c\u8bc1\u7801" data-node-name="validCodeInput">','<em class="c-red warning isNull" style="display: none;"><strong></strong>\u9a8c\u8bc1\u7801\u4e0d\u4e3a\u7a7a</em>','<em class="c-red warning isError" style="display: none;"><strong></strong>\u9a8c\u8bc1\u7801\u9519\u8bef</em>','<span class="clCodeImg"><img src=""></span>',"</div>","</div>",'<button type="submit" data-node-name="subtn" isappear="true" data-sceneid="'+a+'">\u53d1\u9001</button>',"</div>","</div>","</div>","</div>",'<div class="rigIphone" node-name="friendlyTip">','<div class="rigCodeBox">',"<dl>",'<dt><img src="//style.org.hc360.com/images/detail/mysite/siteconfig/new_product/newImg/codeImg_3.jpg"></dt>',"<dd>\u5173\u6ce8\u6167\u806a\u91c7\u8d2d<br>\u627e\u597d\u8d27\uff0c\u66f4\u65b9\u4fbf</dd>","</dl>","</div>","</div>"];s.append(d.join("")),n.getHistoryMsg(function(){var i=['<div class="clBoxLeft">','<em class="clImg"></em>','<div class="clImgRig">','<p class="clTime">\u5e97\u7ecf\u7406  '+n.getDateTime(!0)+"</p>",'<div class="ConsulList">',"<em></em>","<p>\u4f60\u597d\uff0c\u6b22\u8fce\u5149\u4e34"+n.defaultOptions.companyName+"\uff0c\u8bf7\u53d1\u9001\u60a8\u8981\u54a8\u8be2\u7684\u5185\u5bb9\u3002</p>","</div>","</div>","</div>"];e("#cInnerBox").append(i.join("")).scrollTop(e("#cInnerBox")[0].scrollHeight);var t=e.cookie("LoginID")?e.cookie("newhcproviderid")||e.cookie("hc360_userid"):e.cookie("HC_anonyBuyerId")||"";e("#validcodeCon").find(".clCodeImg img").attr("src",'//my.b2b.hc360.com/my/turbine/action/outerinf.OnlinePcIMAction/eventsubmit_doGenerateimagecode/doGenerateimagecode?date="'+new Date+"&buyid="+t)}),n.bindEvent(s)}else e.when(n.getBindStatusDef()).done(function(i){i&&"200"==i.code&&(n.defaultOptions.isBindWX=!0);var t="\u5546\u5bb6\u56de\u590d\u6162\uff1f<br>\u53ef\u626b\u7801\u5fae\u4fe1\u63a5\u6536\u56de\u590d\u4fe1\u606f";n.defaultOptions.isBindWX||(t="\u5173\u6ce8\u6167\u806a\u91c7\u8d2d<br>\u627e\u597d\u8d27\uff0c\u66f4\u65b9\u4fbf"),n.defaultOptions.consultContainer=e("<div>",{"class":"Consultation","data-node-name":"queryDialog","data-startTime":n.getDateTime(!0)}).appendTo("body").show();var s=n.defaultOptions.consultContainer,d=['<div class="ConsultationCon">','<div class="mTitle">','<div class="mTitLeft">',"<em></em>",'<span class="borLeft">'+n.defaultOptions.companyName+"</span>","</div>",'<span class="mCloseBtn" data-node-nane="closeInqueryDialog">\u5173\u95ed</span>',"</div>",'<div class="ConsulCon">','<div class="ConsulBox">','<div class="clTop" id="cInnerBox"></div>','<div class="clBot">','<div class="clBotText">','<textarea name="" data-node-name="area" placeholder="\u8bf7\u5728\u6b64\u76f4\u63a5\u8f93\u5165\u60a8\u8981\u91c7\u8d2d\u7684\u4ea7\u54c1\u53ca\u5176\u4ed6\u9700\u6c42"></textarea>','<p class="textareaLen" data-node-name="maxLen">\u8fd8\u53ef\u4ee5\u8f93\u5165150\u5b57</p>','<p class="ProhibitedTxt" style="display: none;"><strong></strong>\u5185\u5bb9\u542b\u6709\u8fdd\u7981\u8bcd</p>',"</div>","</div>",'<div class="clBotInput">','<div id="mobilephoneCon">',"<span><em>*</em>\u7535\u8bdd\u53f7\u7801</span>",'<div class="bInputBox">','<input type="text" style="color: rgb(162, 162, 162);" maxLength="11" value="\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801" name="MP" data-node-name="MP">','<em class="c-red warning isNull" style="display: none;"><strong></strong>\u624b\u673a\u53f7\u4e0d\u80fd\u4e3a\u7a7a</em>','<em class="c-red warning isError" style="display: none;"><strong></strong>\u8bf7\u586b\u5199\u6b63\u786e\u7684\u624b\u673a\u53f7</em>',"</div>","</div>",'<div id="validcodeCon">',"<span><em>*</em>\u9a8c\u8bc1\u7801</span>",'<div class="clCode">','<input type="text" class="w210" style="color:#999999;"maxLength="4" value="\u9a8c\u8bc1\u7801" data-node-name="validCodeInput">','<em class="c-red warning isNull" style="display: none;"><strong></strong>\u9a8c\u8bc1\u7801\u4e0d\u4e3a\u7a7a</em>','<em class="c-red warning isError" style="display: none;"><strong></strong>\u9a8c\u8bc1\u7801\u9519\u8bef</em>','<span class="clCodeImg"><img src=""></span>',"</div>","</div>",'<button type="submit" data-node-name="subtn" isappear="true" data-sceneid="'+a+'">\u53d1\u9001</button>',"</div>","</div>","</div>","</div>",'<div class="rigIphone" node-name="friendlyTip">','<div class="rigCodeBox">',"<dl>",'<dt><img src="'+o+'"></dt>',"<dd>"+t+"</dd>","</dl>","</div>","</div>"];s.append(d.join("")),n.getHistoryMsg(function(){var i=['<div class="clBoxLeft">','<em class="clImg"></em>','<div class="clImgRig">','<p class="clTime">\u5e97\u7ecf\u7406  '+n.getDateTime(!0)+"</p>",'<div class="ConsulList">',"<em></em>","<p>\u4f60\u597d\uff0c\u6b22\u8fce\u5149\u4e34"+n.defaultOptions.companyName+"\uff0c\u8bf7\u53d1\u9001\u60a8\u8981\u54a8\u8be2\u7684\u5185\u5bb9\u3002</p>","</div>","</div>","</div>"];e("#cInnerBox").append(i.join("")).scrollTop(e("#cInnerBox")[0].scrollHeight);var t=e.cookie("LoginID")?e.cookie("newhcproviderid")||e.cookie("hc360_userid"):e.cookie("HC_anonyBuyerId")||"";e("#validcodeCon").find(".clCodeImg img").attr("src",'//my.b2b.hc360.com/my/turbine/action/outerinf.OnlinePcIMAction/eventsubmit_doGenerateimagecode/doGenerateimagecode?date="'+new Date+"&buyid="+t)}),n.defaultOptions.isBindWX&&(n.defaultOptions.interval=setInterval(function(){n.loopGetMsgPer10s(s)},1e4)),n.bindEvent(s)}).fail(function(){console.warn("\u83b7\u53d6\u5fae\u4fe1\u7ed1\u5b9a\u72b6\u6001\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01")})}).fail(function(){alert("\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01")}))})},bindEvent:function(n){var i=this,t="#333333",a="#a2a2a2";n.find(".clCodeImg").trigger("click");var o={MP:{selector:'input[data-node-name="MP"]',defaultValue:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801",reg:/^1\d{10}$/,notInput:/\D+/g,maxLen:11},contentArea:{selector:'[data-node-name="area"]',defaultValue:"\u8bf7\u5728\u6b64\u76f4\u63a5\u8f93\u5165\u60a8\u8981\u91c7\u8d2d\u7684\u4ea7\u54c1\u53ca\u5176\u4ed6\u9700\u6c42",notInput:/[\xa7\u3003\u3013\u25cb\u25b3\u25b2\u25ce\u2606\u2605\u25c7\u25c6\u25a1\u25a0\u25bd\u25bc\u32a3\ufe3f\ufe39\ufe3d_\ufe41\ufe43\ufe3b\ufe36\ufe38\ufe40\ufe3a\ufe3e\u02c9\ufe42\ufe44\ufe3c\u2605]/g,maxLen:150},validCode:{selector:'input[data-node-name="validCodeInput"]',defaultValue:"\u9a8c\u8bc1\u7801",notInput:/\D+/g,maxLen:4,isMast:!0}};e.each(o,function(n,i){var o=e(i.selector),s=i.defaultValue,d=i.reg,c=i.maxLen;o.on("focus",function(){var n=e(this).val();n!=s&&""!=n||e(this).val("").css("color",t),e(this).closest("div").find(".warning").hide()}).on("blur",function(){var i=e(this).val();"MP"==n?(""==i&&(e(this).val(s).css("color",a),e(this).parent().find("em.isNull").show()),d.test(i)?"":e(this).parent().find("em.isError").show()):"contentArea"==n?""==i?e(this).attr("placeholder",s):"":""==i?e(this).val(s).css("color",a):""}).on("change keyup",function(){var t=e(this).val();i.notInput?e(this).val(t.replace(i.notInput,"")):"",t.length>c?e(this).val(t.substr(0,c)):"","contentArea"==n&&e(this).closest("div").find('[data-node-name="maxLen"]').html("\u8fd8\u53ef\u4ee5\u8f93\u5165"+(i.maxLen-t.length)+"\u5b57")})}),n.find(".warning").on("click",function(){e(this).closest("div").find("[data-node-name]").focus()}),n.find('[data-node-nane="closeInqueryDialog"]').on("click",function(){n.siblings(".dAlertBoxBg").hide(),n.remove(),i.defaultOptions.element.removeAttr("isopen"),i.defaultOptions.consultContainer="",i.defaultOptions.interval&&clearInterval(i.defaultOptions.interval)}),n.find("#cInnerBox").on("click","p.moreList",function(){var n=e(this),t=e(this).next("div").attr("data-id")||e(this).next("div.moreHistory").children(":first").attr("data-id");e.ajax({url:"//my.b2b.hc360.com/my/turbine/action/outerinf.OnlinePcIMAction/eventsubmit_doGethismsg/doGethismsg",type:"GET",timeout:3e3,data:{isLogon:e.cookie("LoginID")?"1":"0",buyid:e.cookie("LoginID")?e.cookie("newhcproviderid")||e.cookie("hc360_userid"):e.cookie("HC_anonyBuyerId")||"",spid:i.defaultOptions.providerId,minid:t},dataType:"jsonp",jsonpCallback:"callback",success:function(i){if(i&&i.length>0){n.after('<div class="moreHistory"></div>');for(var t=i,a=0;a<t.length;a++){if("0"==t[a].infokind){var o=['<div class="clBoxRig" data-id="'+t[a].id+'">','<em class="clImg"></em>','<div class="clImgRig">','<p class="clTime">\u6211  '+t[a].createtime+"</p>",'<div class="ConsulList">',"<em></em>","<p>"+t[a].purchaseinfo+"</p>","</div>","</div>","</div>"];e(".moreHistory:eq(0)").append(o.join(""))}else if("1"==t[a].infokind){var s=['<div class="clBoxLeft" data-id="'+t[a].id+'">','<em class="clImg"></em>','<div class="clImgRig">','<p class="clTime">\u5e97\u7ecf\u7406  '+t[a].createtime+"</p>",'<div class="ConsulList">',"<em></em>","<p>"+t[a].purchaseinfo+"</p>","</div>","</div>","</div>"];e(".moreHistory:eq(0)").append(s.join(""))}i.length<15&&n.remove()}}},error:function(){alert("\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01")}})}),n.on("click",".clCodeImg",function(){var n=e.cookie("LoginID")?e.cookie("newhcproviderid")||e.cookie("hc360_userid"):e.cookie("HC_anonyBuyerId")||"";e(this).find("img").attr("src",'//my.b2b.hc360.com/my/turbine/action/outerinf.OnlinePcIMAction/eventsubmit_doGenerateimagecode/doGenerateimagecode?date="'+(new Date).getTime()+"&buyid="+n)}),n.find('[data-node-name="subtn"]').click(function(){var t=e(this);t.addClass("cGrayBtn").attr("disabled","disabled"),i.sendEvent(t.attr("data-sceneid")||"",n,o)})},sendEvent:function(n,i,t){function a(){e.ajax({url:"//my.b2b.hc360.com/my/turbine/action/outerinf.OnlinePcIMAction/eventsubmit_doSendmsg/doSendmsg",type:"GET",timeout:5e3,data:{isLogon:e.cookie("LoginID")?"1":"0",buyid:e.cookie("LoginID")?e.cookie("newhcproviderid")||e.cookie("hc360_userid"):e.cookie("HC_anonyBuyerId")||"",spid:o.defaultOptions.providerId,MP:encodeURIComponent(c.val()),plantitle:encodeURIComponent(d.val()),contacter:encodeURIComponent(l),introduce:encodeURIComponent(d.val()),comeUrl:window.location.href,qrcodeid:n,picCode:"\u9a8c\u8bc1\u7801"==e.trim(e(t.validCode.selector).val())?"":e.trim(e(t.validCode.selector).val())},dataType:"jsonp",jsonpCallback:"callback",success:function(n){if(n)if(0==n.code)alert("\u53d1\u9001\u5931\u8d25\uff0c\u7a0d\u540e\u91cd\u8bd5\uff01"),i.find('button[data-node-name="subtn"]').removeClass("cGrayBtn").removeAttr("disabled");else if(1==n.code){var a=i.find('[data-node-name="subtn"]').attr("isappear");if(a&&i.find('[node-name="friendlyTip"]').addClass("left530"),n.cntADay>0){if(r.hide(),d.siblings("p.textareaLen").text("\u8fd8\u53ef\u4ee5\u8f93\u5165150\u5b57"),n.cntADay%5==0?(m.show().find(".clCodeImg").trigger("click"),m.find('[data-node-name="validCodeInput"]').val(""),m.find("em.warning").hide()):m.hide(),o.renderMessageContent(n.msgId,t),!o.defaultOptions.isBindWX||o.defaultOptions.is3y){var s=['<div class="clBoxLeft">','<em class="clImg"></em>','<div class="clImgRig">','<p class="clTime">\u5e97\u7ecf\u7406  '+o.getDateTime(!0)+"</p>",'<div class="ConsulList">',"<em></em>","<p>\u4fdd\u6301\u7535\u8bdd\u7545\u901a\uff0c\u5546\u5bb6\u4f1a\u7535\u8bdd\u8054\u7cfb\u60a8\u3002\u5173\u6ce8\u6167\u806a\u91c7\u8d2d\uff0c\u627e\u597d\u8d27\u66f4\u65b9\u4fbf\uff01</p>","</div>","</div>","</div>"];setTimeout(function(){e("#cInnerBox").append(s.join("")).scrollTop(e("#cInnerBox")[0].scrollHeight)},1e3)}e("#cInnerBox").scrollTop(e("#cInnerBox")[0].scrollHeight),i.find('button[data-node-name="subtn"]').removeClass("cGrayBtn").removeAttr("disabled").removeAttr("isappear")}}else if(3==n.code)alert("\u60a8\u4e0d\u80fd\u7ed9\u81ea\u5df1\u53d1\u7559\u8a00\uff01"),i.find('button[data-node-name="subtn"]').removeClass("cGrayBtn").removeAttr("disabled");else if(5==n.code){m.find(".clCode em.isError").show();var c=e.cookie("LoginID")?e.cookie("newhcproviderid")||e.cookie("hc360_userid"):e.cookie("HC_anonyBuyerId")||"";m.find(".clCodeImg img").attr("src",'//my.b2b.hc360.com/my/turbine/action/outerinf.OnlinePcIMAction/eventsubmit_doGenerateimagecode/doGenerateimagecode?date="'+(new Date).getTime()+"&buyid="+c),e('button[data-node-name="subtn"]').removeClass("cGrayBtn").removeAttr("disabled")}else alert("\u7559\u8a00\u6b21\u6570\u8d85\u9650\uff0c\u7a0d\u540e\u91cd\u8bd5\uff01"),i.find('button[data-node-name="subtn"]').removeClass("cGrayBtn").removeAttr("disabled")},error:function(e){i.find('button[data-node-name="subtn"]').removeClass("cGrayBtn").removeAttr("disabled"),alert("\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01")}})}var o=this,s=!0,d=e(t.contentArea.selector),c=e(t.MP.selector),l="",r=i.find("#mobilephoneCon"),m=i.find("#validcodeCon");e.each(t,function(n,i){e(i.selector).focus().blur()}),""==e.trim(d.val())&&(alert("\u8bf7\u8f93\u5165\u804a\u5929\u5185\u5bb9\uff01"),s=!1),r.is(":visible")&&r.find(".bInputBox em.warning").is(":visible")&&(s=!1),m.is(":visible")&&m.find(".clCode em.warning").is(":visible")&&(s=!1),s?a():i.find('button[data-node-name="subtn"]').removeClass("cGrayBtn").removeAttr("disabled")},renderMessageContent:function(n,i){var t=this,a='<div class="clBoxRig inputCount" data-id="'+n+'"><em class="clImg"></em><div class="clImgRig"><p class="name clTime">\u6211 '+t.getDateTime(!0)+'</p><div class="ConsulList"><em></em><p>'+e(i.contentArea.selector).val()+"</p></div></div></div>";e("#cInnerBox").append(a),e(i.contentArea.selector).val(""),e.each(i,function(n,i){e(i.selector).css("color","gray")})},loopGetMsgPer10s:function(n){function i(e,n){if(!n)return e;var i=Date.parse(new Date(e.replace(/-/g,"/"))),t=Date.parse(new Date(n.replace(/-/g,"/")));return i-t>0?e:n}var t=this;e.ajax({url:"//my.b2b.hc360.com/my/turbine/action/outerinf.OnlinePcIMAction/eventsubmit_doGetpollintervalmsg/doGetpollintervalmsg",type:"GET",timeout:5e3,data:{buyid:e.cookie("LoginID")?e.cookie("newhcproviderid")||e.cookie("hc360_userid"):e.cookie("HC_anonyBuyerId")||"",isLogon:e.cookie("LoginID")?"1":"0",spid:t.defaultOptions.providerId,maxBpID:n.find("#cInnerBox").children(".clBoxRig:last").attr("data-id")||"",maxSpID:n.find("#cInnerBox").children(".clBoxLeft[data-id]:last").attr("data-id")||""},dataType:"jsonp",jsonpCallback:"callback",success:function(a){if(!t.defaultOptions.consultContainer)return!1;var o=n.find("#cInnerBox");if(a&&a.length>0){for(var s=a,d="",c=0;c<s.length;c++){if("0"==s[c].infokind){var l=['<div class="clBoxRig" data-id="'+s[c].id+'">','<em class="clImg"></em>','<div class="clImgRig">','<p class="clTime">\u6211  <span>'+s[c].createtime+"</span></p>",'<div class="ConsulList">',"<em></em>","<p>"+s[c].purchaseinfo||"</p>","</div>","</div>","</div>"];o.append(l.join(""))}else if("1"==s[c].infokind){var r=['<div class="clBoxLeft" data-id="'+s[c].id+'">','<em class="clImg"></em>','<div class="clImgRig">','<p class="clTime">\u5e97\u7ecf\u7406  <span>'+s[c].createtime+"</span></p>",'<div class="ConsulList">',"<em></em>","<p>"+s[c].purchaseinfo||"</p>","</div>","</div>","</div>"];o.append(r.join(""))}c==s.length-1&&(d=s[c].createtime)}o.scrollTop(e("#cInnerBox")[0].scrollHeight)}else d=o.children("[data-id]:last").find("p.clTime span").text();var m=e(".Consultation:visible").attr("data-starttime"),p=i(m,d),u=t.getDateTime(!0),v=t.getDateDifference(p,u);v>=30&&n.find('[data-node-nane="closeInqueryDialog"]').trigger("click")},error:function(){alert("\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01")}})},getDateTime:function(e){function n(e){return Number(e)<10&&(e="0"+e),e}var i=new Date,t=i.getFullYear(),a=i.getMonth()+1,o=i.getDate(),s=i.getHours(),d=i.getMinutes(),c=i.getSeconds();return e?t+"-"+n(a)+"-"+n(o)+" "+n(s)+":"+n(d)+":"+n(c):n(s)+":"+n(d)+":"+n(c)},getDateDifference:function(e,n){if(e>n)return console.log("\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u5927\u4e8e\u7ed3\u675f\u65f6\u95f4\uff01"),!1;var i=e.substr(0,10).split("-"),t=n.substr(0,10).split("-"),a=new Date(i[1]+-+i[2]+-+i[0]),o=new Date(t[1]+-+t[2]+-+t[0]),s=parseInt(Math.abs(o-a)/1e3/60),d=60*parseInt(e.substr(11,2))+parseInt(e.substr(14,2)),c=60*parseInt(n.substr(11,2))+parseInt(n.substr(14,2)),l=c-d,r=s+l;return r}}}(jQuery)}]);