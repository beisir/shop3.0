!function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="http://style.org.hc360.cn/js/module/shop3.0/dist/",t(0)}([function(e,t){!function(e){e.fn.queryDialog=function(n){return this.each(function(i,a){e.extend(!0,n,{element:e(a)});var s=new t(n);s.init()})};var t=function(t){this.defaultOptions={is3y:!1,isBindWX:!1,element:"",companyName:window.infoname||""},e.extend(this.defaultOptions,t)};t.prototype={init:function(){this.createDialogHtml()},bindStatusDef:function(){return e.ajax({url:"http://madata.hc360.com/mobileweb/m/get/bindstatus",dataType:"jsonp",data:{imid:window.company_username||window.welfarename||window.userName}})},getMsgContent:function(){return e.ajax({url:"http://my.b2b.hc360.com/my/turbine/action/outerinf.OnlinePcIMAction/eventsubmit_doGethismsg/doGethismsg",type:"GET",timeout:3e3,data:{buyid:e.cookie("LoginID")?e.cookie("newhcproviderid")||e.cookie("hc360_userid"):e.cookie("HC_anonyBuyerId")||"",isLogon:e.cookie("LoginID")?"1":"0",spid:window.scyps.sc.providerId||""},dataType:"jsonp",jsonpCallback:"callback"})},getHistoryMsg:function(t){var n=this;e.when(n.getMsgContent()).done(function(i){if(i&&i.length>0){var a=i,s=a[0].qrcodeid;e('button[data-node-name="subtn"]').attr("data-sceneid",s);for(var o=0;o<a.length;o++)if("0"==a[o].infokind){var c=['<div class="clBoxRig" data-id="'+a[o].id+'">','<em class="clImg"></em>','<div class="clImgRig">','<p class="clTime">\u6211  <span>'+a[o].createtime+"</span></p>",'<div class="ConsulList">',"<em></em>","<p>"+a[o].purchaseinfo||"</p>","</div>","</div>","</div>"];e("#cInnerBox").append(c.join(""))}else if("1"==a[o].infokind){var l=['<div class="clBoxLeft" data-id="'+a[o].id+'">','<em class="clImg"></em>','<div class="clImgRig">','<p class="clTime">\u5e97\u7ecf\u7406  <span>'+a[o].createtime+"</span></p>",'<div class="ConsulList">',"<em></em>","<p>"+a[o].purchaseinfo||"</p>","</div>","</div>","</div>"];e("#cInnerBox").append(l.join(""))}15==i.length&&e("#cInnerBox").prepend('<p class="moreList"><a href="javascript:;">\u70b9\u51fb\u67e5\u770b\u66f4\u591a</a></p>');var d=e('span[ele-type="closeWindow"]');e.when(n.getCodeUrlBySceneid(s)).done(function(e){d.attr("data-picurl",e.weChatPic)}).fail(function(){d.attr("data-picurl","http://style.org.hc360.com/images/detail/mysite/siteconfig/new_product/newImg/cRigImg.png")})}e("#cInnerBox").scrollTop(e("#cInnerBox")[0].scrollHeight),t&&t()}).fail(function(){console.log("Failed to obtain data,Please try again later!")})},createDialogHtml:function(){var t=this,n=e(".dAlertBoxBg");t.defaultOptions.element.on("click",function(){if(0==n.length?n=e("<div>",{"class":"dAlertBoxBg consultBg"}).appendTo("body").show():n.show(),t.is3y){var i=(e("<div>",{"class":"Consultation","data-startTime":t.getDateTime(!0)}).appendTo("body").show(),['<div class="ConsultationCon">','<div class="mTitle">','<div class="mTitLeft">',"<em></em>","<span>\u5c0f\u6167</span>",'<span class="borLeft">'+t.companyName+"</span>","</div>",'<span class="mCloseBtn">\u5173\u95ed</span>',"</div>",'<div class="ConsulCon">','<div class="ConsulBox">','<div class="clTop"></div>','<div class="clBot">','<div class="clBotText">','<textarea name="" placeholder="\u8bf7\u5728\u6b64\u76f4\u63a5\u8f93\u5165\u60a8\u8981\u91c7\u8d2d\u7684\u4ea7\u54c1\u53ca\u5176\u4ed6\u9700\u6c42"></textarea>','<p class="textareaLen">\u8fd8\u53ef\u4ee5\u8f93\u5165150\u5b57</p>','<p class="ProhibitedTxt" style="display: none;"><strong></strong>\u5185\u5bb9\u542b\u6709\u8fdd\u7981\u8bcd</p>',"</div>","</div>",'<div class="clBotInput">','<div id="mobilephoneCon">',"<span><em>*</em>\u7535\u8bdd\u53f7\u7801</span>",'<div class="bInputBox">','<input type="text" style="color: rgb(162, 162, 162);" value="\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801" name="MP" data-node-name="MP">','<em class="c-red warning isNull" style="display: inline;"><strong></strong>\u624b\u673a\u53f7\u4e0d\u80fd\u4e3a\u7a7a</em>','<em class="c-red warning isError" style="display: inline;"><strong></strong>\u8bf7\u586b\u5199\u6b63\u786e\u7684\u624b\u673a\u53f7</em>',"</div>","</div>",'<div id="validcodeCon" style="display:none;">',"<span><em>*</em>\u9a8c\u8bc1\u7801</span>",'<div class="clCode">','<input type="text" class="w210" style="color:#999999;" value="\u9a8c\u8bc1\u7801" data-node-name="validCodeInput">','<em class="c-red warning isNull"><strong></strong>\u9a8c\u8bc1\u7801\u4e0d\u4e3a\u7a7a</em>','<em class="c-red warning isError"><strong></strong>\u9a8c\u8bc1\u7801\u9519\u8bef</em>','<span class="clCodeImg"><img src="http://detail.b2b.hc360.com/detail/turbine/action/ajax.Sendcodebysupplyselfv2/eventsubmit_doGenerateimagecode/doGenerateimagecode?date="></span>',"</div>","</div>",'<button type="submit">\u53d1\u9001</button>',"</div>","</div>","</div>","</div>"]);e(".Consultation").append(i.join("")),t.getHistoryMsg(function(){var t=['<div class="clBoxLeft">','<em class="clImg"></em>','<div class="clImgRig">','<p class="clTime">\u5e97\u7ecf\u7406  '+that.getDateTime(!0)+"</p>",'<div class="ConsulList">',"<em></em>","<p>\u4f60\u597d\uff0c\u6b22\u8fce\u5149\u4e34"+that.companyName+"\uff0c\u8bf7\u53d1\u9001\u60a8\u8981\u54a8\u8be2\u7684\u5185\u5bb9\u3002</p>","</div>","</div>","</div>"];e("#cInnerBox").append(t.join("")).scrollTop(e("#cInnerBox")[0].scrollHeight)})}})},getDateTime:function(e){function t(e){return Number(e)<10&&(e="0"+e),e}var n=new Date,i=n.getFullYear(),a=n.getMonth()+1,s=n.getDate(),o=n.getHours(),c=n.getMinutes(),l=n.getSeconds();return e?i+"-"+t(a)+"-"+t(s)+" "+t(o)+":"+t(c)+":"+t(l):t(o)+":"+t(c)+":"+t(l)}}}(jQuery)}]);